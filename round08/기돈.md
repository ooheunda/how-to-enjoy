## 23장 실행 컨텍스트

- 소스코드의 타입

| 타입      | 컨텍스트           | 설명                                                             |
| --------- | ------------------ | ---------------------------------------------------------------- |
| 전역 코드 | 전역 실행 컨텍스트 | 전역에 존재하는 소스코드. 함수, 클래스 등의 내부코드 미포함      |
| 함수 코드 | 함수 실행 컨텍스트 | 함수 내부에 존재하는 소스코드. 함수, 클래스 등의 내부코드 미포함 |
| eval 코드 | eval 실행 컨텍스트 | 빌트인 전역함수인 eval 함수에 인수로 전달되어 실행되는 소스코드  |
| 모듈 코드 | 모듈 실행 컨텍스트 | 모듈 내부에 존재하는 소스코드. 함수, 클래스 등의 내부코드 미포함 |

- 소스코드의 평가와 실행

  - 과정 :
    1. 소스코드의 평가
       1. 실행 컨텍스트 생성
       2. 변수, 함수 등의 선언문만 먼저 실행
       3. 생성된 변수, 함수 식별자를 키로, 실행 컨텍스트가 관리하는 스코프에 등록
    2. 소스코드의 실행
       1. (선언문을 제외한) 소스코드 순차 실행 = 런타임 시작
       2. 실행에 필요한 변수, 함수는 실행 컨텍스트가 관리하는 스코프에서 검색해 췯득
       3. 소스코드의 실행 결과는 실행 컨텍스트가 관리하는 스코프에 등록

- 실행 컨텍스트의 역할
  - 소스코드를 실행하는 데 필요한 환경을 제공하고, 코드의 실행 결과를 실제로 관리하는 영역
  1. 전역 코드 평가
     1. 선언문 먼저 실행
     2. 변수, 함수가 실행 컨텍스트가 관리하는 전역 스코프에 등록
     3. var로 선언된 전역 변수, 함수 선언문으로 정의된 전역 함수는 전역 객체의 프로퍼티와 메서드가 됌
  2. 전역 코드 실행
     1. 런타임 시작
     2. 전역 변수에 값 할당, 함수 호출
     3. 함수 호출 시, 전역 코드의 실행을 중단하고 코드 실행 순서를 변경해 함수 내부로 진입
  3. 함수 코드 평가
     1. 함수 내부로 진입하면, 함수 코드를 평가
     2. 매개변수와 지역 변수 선언문 실행 => 매개변수와 지역변수가 실행 컨텍스트가 관리하는 지역 스코프에 등록
     3. arguments 객체가 생성되어 지역스코프에 등록, this 바인딩 결정
  4. 함수 코드 실행
     1. 함수 코드 순차 실행
  - 식별자와 스코프는 실행 컨텍스트의 렉시컬 환경으로 관리하고, 코드 실행 순서는 `실행 컨텍스트 스택`으로 관리
- 실행 컨텍스트 스택

  ```js
  const x = 1;
  function foo() {
    function bar() {}
    bar();
  }
  foo();
  ```

  |                    |                        | bar 함수 실행 컨텍스트 |                        |                    |
  | ------------------ | ---------------------- | ---------------------- | ---------------------- | ------------------ |
  |                    | foo 함수 실행 컨텍스트 | foo 함수 실행 컨텍스트 | foo 함수 실행 컨텍스트 |                    |
  | 전역 실행 컨텍스트 | 전역 실행 컨텍스트     | 전역 실행 컨텍스트     | 전역 실행 컨텍스트     | 전역 실행 컨텍스트 |

- 렉시컬 환경
  - 식별자와 식별자에 바인딩된 값, 그리고 상위 스코프에 대한 참조를 기록하는 자료구조
  - 실행 컨텍스트를 구성하는 컴포넌트로, 스코프와 식별자를 관리
    ![image](https://github.com/ooheunda/how-to-enjoy/assets/64675543/fca4e42d-a588-4b66-9008-812754084b81)
  - 구성
    - 환경 레코드
      - 스코프에 포함된 식별자를 등록하고 등록한 식별자에 바인딩 된 값을 관리하는 저장소
      - 소스코드 타입 따라 관리 내용에 차이 존재

    - 외부 렉시컬 환경에 대한 참조
      - 상위 스코프 = 상위 코드의 렉시컬 환경
- 실행 컨텍스트의 생성과 식별자 검색 과정
  - 전역 객체 생성
  - 전역 코드 평가
  - 
